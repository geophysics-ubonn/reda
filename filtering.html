
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Filtering Data &#8212; REDA 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="_examples/index.html" />
    <link rel="prev" title="Data Containers" href="data_containers.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/reda_logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Reproducible electrical data analysis</p>








    

<p>
<a class="badge" href="https://travis-ci.org/geophysics-ubonn/reda">
    <img
        alt="https://secure.travis-ci.org/geophysics-ubonn/reda.svg?branch=master"
        src="https://secure.travis-ci.org/geophysics-ubonn/reda.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_containers.html">Data Containers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Filtering Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="importers.html">Data Importers</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_data.html">Test data</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging reda</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/geophysics-ubonn/reda">Source code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="data_containers.html" title="previous chapter">Data Containers</a></li>
      <li>Next: <a href="_examples/index.html" title="next chapter">Examples</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="filtering-data">
<h1>Filtering Data<a class="headerlink" href="#filtering-data" title="Permalink to this headline">¶</a></h1>
<p>Data filtering should be done using of the provided filter functions. This way
we can track the impact of each filter operation for later review.</p>
<div class="section" id="working-with-nan-data">
<h2>Working with NaN data<a class="headerlink" href="#working-with-nan-data" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We implement the generic filter functions <cite>.filter()</cite> and <cite>.query()</cite>.</p>
</div>
<p>Sometimes we want to work with columns that contain NaN values, for example
normal-reciprocal differences with some data not having a reciprocal
counterpart. If we just use filter operations such as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seit</span> <span class="o">=</span> <span class="n">reda</span><span class="o">.</span><span class="n">sEIT</span><span class="p">()</span>
<span class="c1"># ... load data</span>
<span class="n">seit</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;rdiff &gt; -5 and rdiff &lt; -5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>then we will loose all data points that did not have a normal-reciprocal
differences in the beginning. This is caused by the filter operation
validating the above shown expression as False for NaN values. To overcome
this we can use the fact that NaN always is inequal to itself, <cite>NaN != NaN</cite>.
The following filter function will retain all NaN valued rows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seit</span> <span class="o">=</span> <span class="n">reda</span><span class="o">.</span><span class="n">sEIT</span><span class="p">()</span>
<span class="c1"># ... load data</span>
<span class="n">seit</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(rdiff != rdiff) or (rdiff &gt; -5 and rdiff &lt; -5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="implementing-new-filter-methods">
<h2>Implementing new filter methods<a class="headerlink" href="#implementing-new-filter-methods" title="Permalink to this headline">¶</a></h2>
<p>Sometimes the generic filter interface using the <cite>.filter</cite> functions of the
containers is not sufficient or convenient for complex filter procedures.
In this case it makes sense to create new <cite>filter_XXX</cite> functions in the
containers, e.g., to pre-process the data before applying filters based on the
processing results.  If possible, those functions should internally use the
<cite>.filter</cite> functions of the containers to ensure a clean logging of the changes.</p>
<p>Otherweise, use the context manager <cite>LogDataChanges</cite> to monitor the DataFrame
<cite>self.data</cite> , and report any changes in the journal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reda.utils.decorators_and_managers</span> <span class="kn">import</span> <span class="n">LogDataChanges</span>
<span class="k">with</span> <span class="n">LogDataChanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_action</span><span class="o">=</span><span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="n">filter_query</span><span class="o">=</span><span class="s1">&#39;import&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2019, M. Weigand and F. M. Wagner and others.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/filtering.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>